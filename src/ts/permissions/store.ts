import type { PermissionStorage } from "$types/permission";

export const PERMISSIONS = [
  "PERMISSION_USER_CONTEXT_ACCOUNT",
  "PERMISSION_USER_CONTEXT_APPLICATIONS",
  "PERMISSION_USER_CONTEXT_APPREGISTRATION",
  "PERMISSION_USER_CONTEXT_ELEVATION",
  "PERMISSION_USER_CONTEXT_FILESYSTEM",
  "PERMISSION_USER_CONTEXT_HELPERS",
  "PERMISSION_USER_CONTEXT_ICONS",
  "PERMISSION_USER_CONTEXT_NOTIFICATIONS",
  "PERMISSION_USER_CONTEXT_POWER",
  "PERMISSION_USER_CONTEXT_PREFERENCES",
  "PERMISSION_USER_CONTEXT_SHORTCUTS",
  "PERMISSION_USER_CONTEXT_SPAWN",
  "PERMISSION_USER_CONTEXT_THEMES",
  "PERMISSION_USER_CONTEXT_WALLPAPER",
  "PERMISSION_USER_CONTEXT_WORKSPACES",
  "PERMISSION_FS_READ_EXTERNAL",
  "PERMISSION_FS_WRITE_EXTERNAL",
  "PERMISSION_FS_READ_APPLICATIONS",
  "PERMISSION_FS_WRITE_APPLICATIONS",
  "PERMISSION_FS_READ_SYSTEM",
  "PERMISSION_FS_WRITE_SYSTEM",
  "PERMISSION_FS_READ_CONFIG",
  "PERMISSION_FS_WRITE_CONFIG",
  "PERMISSION_FS_READ_USER",
  "PERMISSION_FS_WRITE_USER",
  "PERMISSION_FS_READ",
  "PERMISSION_FS_WRITE",
  "PERMISSION_FS_DRIVES",
  "PERMISSION_KMOD_ENV",
  "PERMISSION_APPRENDERER",
] as const;
export const PERMISSION_NAMES = {
  "PERMISSION_USER_CONTEXT_ACCOUNT": "Account",
  "PERMISSION_USER_CONTEXT_APPLICATION": "Applications",
  "PERMISSION_USER_CONTEXT_APPREGISTRATION": "App registration",
  "PERMISSION_USER_CONTEXT_ELEVATION": "Elevation",
  "PERMISSION_USER_CONTEXT_FILESYSTEM": "File System",
  "PERMISSION_USER_CONTEXT_HELPERS": "Helpers",
  "PERMISSION_USER_CONTEXT_ICONS": "Icons",
  "PERMISSION_USER_CONTEXT_NOTIFICATIONS": "Notifications",
  "PERMISSION_USER_CONTEXT_POWER": "Power",
  "PERMISSION_USER_CONTEXT_PREFERENCES": "Preferences",
  "PERMISSION_USER_CONTEXT_SHORTCUTS": "Shortcuts",
  "PERMISSION_USER_CONTEXT_SPAWN": "Spawning",
  "PERMISSION_USER_CONTEXT_THEMES": "Themes",
  "PERMISSION_USER_CONTEXT_WALLPAPER": "Wallpapers",
  "PERMISSION_USER_CONTEXT_WORKSPACES": "Workspaces",
  "PERMISSION_FS_READ_EXTERNAL": "Read external file system",
  "PERMISSION_FS_WRITE_EXTERNAL": "Write external file system",
  "PERMISSION_FS_READ_APPLICATIONS": "Read application files",
  "PERMISSION_FS_WRITE_APPLICATIONS": "Write application files",
  "PERMISSION_FS_READ_SYSTEM": "Read system files",
  "PERMISSION_FS_WRITE_SYSTEM": "Write system files",
  "PERMISSION_FS_READ_CONFIG": "Read config files",
  "PERMISSION_FS_WRITE_CONFIG": "Write config files",
  "PERMISSION_FS_READ_USER": "Read user files",
  "PERMISSION_FS_WRITE_USER": "Write user files",
  "PERMISSION_FS_READ": "Read files",
  "PERMISSION_FS_WRITE": "Write files",
  "PERMISSION_FS_DRIVES": "Drives",
  "PERMISSION_KMOD_ENV": "Env kernel module",
  "PERMISSION_APPRENDERER": "AppRenderer",
} as const;
export type PermissionString = (typeof PERMISSIONS)[number];

export const PERMISSION_ERRORS = [
  "PERMERR_ALREADY_OWNED",
  "PERMERR_NOT_DENIED",
  "PERMERR_DENIED",
  "PERMERR_NOT_GRANTED",
  "PERMERR_INVALID_PERMSTR",
  "PERMERR_NATURE_UNKNOWN",
  "PERMERR_ALREADY_DENIED",
  "PERMERR_SUDO_NOT_GRANTED",
  "PERMERR_SUDO_ALREADY_GRANTED",
  "PERMERR_SUDO_INVALID",
  "PERMERR_SUDO_EXPIRED",
  "PERMERR_OK",
] as const;
export type PermissionError = (typeof PERMISSION_ERRORS)[number];

export const PermissionErrorCaptions: Record<PermissionError, string> = {
  PERMERR_ALREADY_OWNED: "Client %c already owns %p",
  PERMERR_NOT_DENIED: "Client %c is not denied %p",
  PERMERR_DENIED: "Client %c has been denied %p",
  PERMERR_NOT_GRANTED: "Client %c has not been granted %p",
  PERMERR_INVALID_PERMSTR: "Permission %p is invalid",
  PERMERR_NATURE_UNKNOWN: "The nature of the process could not be determined",
  PERMERR_ALREADY_DENIED: "Permission %p is already explicitly denied on %c",
  PERMERR_SUDO_ALREADY_GRANTED: "%c already has sudo",
  PERMERR_SUDO_EXPIRED: "Sudo on %c has expired",
  PERMERR_SUDO_INVALID: "Sudo on %c is invalid",
  PERMERR_SUDO_NOT_GRANTED: "Client %c has not been granted sudo",
  PERMERR_OK: "Operation completed successfully",
};

export const DefaultPermissionStorage: PermissionStorage = {
  allowed: {},
  denied: {},
  registration: {},
};
